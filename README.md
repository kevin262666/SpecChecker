# SpecChecker Chrome 擴充套件

一款專為 UI/UX 設計師開發的 Chrome 擴充套件，協助檢查前端切版是否符合設計規範。

## 功能特色

### 🔍 即時樣式檢視器
- 滑鼠懸停顯示元素樣式資訊
- 即時顯示字體大小、行高、字重
- 顯示邊距、內距數值
- 顯示顏色的十六進位值
- 一鍵複製樣式數值

### ⚙️ 自訂規範檢查
- 自訂字體大小範圍檢查
- 設定間距規範標準
- 管理標準色彩清單
- 自動標示不符合規範的元素

### 📊 自動掃描與報告
- 一鍵掃描整個頁面
- 生成詳細檢查報告
- 標示問題元素位置
- 匯出檢查結果

## 安裝方式

1. 下載或克隆此專案
2. 開啟 Chrome 瀏覽器
3. 進入 `chrome://extensions/`
4. 開啟「開發人員模式」
5. 點選「載入未封裝項目」
6. 選擇專案資料夾

## 使用方法

### 基本操作
1. 點選擴充套件圖示開啟控制面板
2. 開啟「啟用檢查」開關
3. 滑鼠懸停在頁面元素上查看樣式
4. 點擊元素複製樣式到剪貼簿
5. 按 ESC 鍵退出檢查模式

### 自訂規範
1. 點選「設定規範」按鈕
2. 設定字體大小、間距範圍
3. 新增或移除標準色彩
4. 儲存設定

### 自動掃描
1. 點選「開始掃描」執行頁面檢查
2. 查看掃描統計結果
3. 點選「檢查報告」查看詳細問題

## 技術規格

- **架構**: Chrome Extension Manifest V3
- **核心技術**: Content Scripts, Chrome Storage API
- **相容性**: Chrome 88+
- **權限**: activeTab, storage, scripting

## 檔案結構

```
SpecChecker/
├── manifest.json          # 擴充套件設定檔
├── background.js           # 背景腳本
├── content.js             # 內容腳本
├── content.css            # 樣式表
├── popup.html             # 主控制面板
├── popup.js               # 控制面板邏輯
├── settings.html          # 設定頁面
├── settings.js            # 設定頁面邏輯
├── icons/                 # 圖示檔案
└── README.md              # 說明文件
```

## 快捷鍵

- `滑鼠懸停`: 顯示元素樣式
- `點擊`: 複製樣式到剪貼簿
- `ESC`: 退出檢查模式

## 開發說明

此擴充套件採用 Manifest V3 規範開發，主要功能模組：

1. **Content Script**: 負責 DOM 元素檢測和樣式讀取
2. **Popup Interface**: 提供主要控制功能
3. **Settings Panel**: 管理自訂規範設定
4. **Background Service Worker**: 處理擴充套件生命週期

## 授權條款

MIT License

## 貢獻指南

歡迎提交 Issue 或 Pull Request 來改善此專案。

## 更新日誌

### v1.5.0 - 支援 iframe 內嵌頁面檢測
- **重大功能**: 修復外掛在 iframe 內嵌頁面無法作用的問題
- **iframe 支援**: 新增 `all_frames: true` 設定，content script 現在會注入到所有 iframe 中
- **智慧定位**: iframe 中的 tooltip 和覆蓋層使用絕對定位，主頁面使用固定定位
- **高優先級顯示**: 提升所有 UI 元素的 z-index 到最大值 (2147483647) 確保正確顯示
- **截圖限制**: iframe 中點擊截圖會提示用戶需要在主頁面操作，避免功能異常
- **防重複初始化**: 每個框架只會創建一個 SpecChecker 實例，避免衝突
- **測試檔案**: 新增 `test-iframe.html` 用於測試 iframe 功能

### v1.4.2 - 修復預設顏色檢測問題
- **重要修復**: 修復預設顏色 #0093c1 被誤判為錯誤的問題
- **格式統一**: 統一 background.js 的預設值格式，與其他檔案保持一致
- **初始化改善**: 擴充功能首次啟動即可正確檢測所有預設顏色
- **用戶體驗**: 無需開啟設定頁面即可正常使用所有功能

### v1.4.1 - 安全性修復
- **安全修復**: 修復 content.js 中的 XSS 漏洞，使用安全的 HTML 轉義
- **程式碼清理**: 移除不必要的調試用 console.log 輸出
- **安全強化**: 新增 escapeHtml 類方法防止注入攻擊

### v1.4.0 - 截圖功能大幅改進
- **新功能**: 點擊網頁時會彈出保存對話框，讓用戶自選截圖保存位置
- **改進**: 使用 Chrome downloads API 提供更好的下載體驗
- **優化**: 截圖檔案命名格式包含詳細時間戳
- **技術**: 新增 "downloads" 權限，重構截圖下載邏輯
- **體驗**: 改善截圖錯誤處理和用戶提示

### v1.3.1 - 安全性更新
- **安全修復**: 修補了在工具提示（tooltip）顯示邏輯中的一個 DOM 型 XSS 漏洞，透過對元素 class 名稱進行適當的淨化處理。
- **程式碼整理**: 從 `manifest.json` 的 `web_accessible_resources` 中移除了未被使用的 `tooltip.html`，以減少擴充功能的潛在攻擊面。

### v1.3.0 - 重大安全修復
- 修正過度權限問題：限制 host_permissions 為 http://*/* 和 https://*/*
- 修正 XSS 風險：替換所有 innerHTML 為安全的 DOM 操作
- 修正不安全的報告生成：使用 Blob + URL.createObjectURL 替代 document.write
- 加強 JSON 輸入驗證：新增檔案大小、格式和內容驗證
- 移除敏感日誌：清理所有 console.log 輸出
- 新增 HTML 轉義函數防止注入攻擊
- 提升整體安全等級，現已適合生產環境使用

### v1.2.0
- 修復設定頁面預設值顯示問題，同步 content.js 和 settings.js 的 getDefaultRules
- 新增匯入匯出設定功能，可備份和分享設定檔案
- 匯出檔案包含版本資訊和匯出日期
- 匯入功能包含格式驗證和錯誤處理

### v1.1.0
- 新增字體大小與行高配對規範檢查
- 字體大小必須為整數，有小數點視為不符合規範
- 新增圓角規範檢查功能
- 改進間距檢查邏輯，支援內距、外距、gap 統一規範
- 修復設定頁面按鈕無反應問題
- 改善 gap 間距視覺化顯示
- 在 popup 和設定頁面顯示版本號

### v1.0.0
- 初始版本發布
- 實作基本樣式檢視功能
- 新增自訂規範設定
- 支援自動掃描與報告生成